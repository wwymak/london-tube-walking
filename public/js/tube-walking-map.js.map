{"version":3,"sources":["../../es6_js/tube-walking-map.js"],"names":[],"mappings":"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","file":"tube-walking-map.js","sourcesContent":["/**\n * Created by wwymak on 19/12/2015.\n */\n\nvar mapWidget = {\n    initMap: function(){\n        mapboxgl.accessToken = 'pk.eyJ1Ijoid3d5bWFrIiwiYSI6IkxEbENMZzgifQ.pxk3bdzd7n8h4pKzc9zozw';\n        var map = new mapboxgl.Map({\n            container: 'map', // container id\n            style: 'mapbox://styles/mapbox/emerald-v8', //stylesheet location\n            center: [-0.1275, 51.5072], // starting position\n            zoom: 12 // starting zoom\n        });\n        return map;\n    },\n\n    /**\n     * query db for tube stations data that are within five mins walk of each other\n     * @returns {*} jquery deferred promise\n     */\n    loadFiveMinsData: function(){\n        return $.ajax('/api/five-mins-walk')\n    },\n\n    parseToGeojson: function(data){\n        var geoJson = {};\n        geoJson.type = \"FeatureCollection\";\n        geoJson.features = []\n        for (let i of data){\n            var routePoints = [];\n            i.routePoints.forEach(function(d){\n                var b = d[1];\n                d[1] = d[0];\n                d[0] = b;\n                routePoints.push(d)\n            });\n            let feature = {};\n            feature.type = \"Feature\";\n            feature.properties= {\n                distance: i.distance\n            };\n            feature.geometry = {\n                \"type\": \"LineString\",\n                \"coordinates\": ([[i.point1.lng,i.point1.lat]]).concat(routePoints, [[i.point2.lng,i.point2.lat]])\n            };\n            geoJson.features.push(feature);\n        }\n        return geoJson;\n    }\n};\n\nvar ldnMap = mapWidget.initMap();\n\nldnMap.on('style.load', () =>{\n    mapWidget.loadFiveMinsData().then(mapWidget.parseToGeojson)\n        .then(function(geojson){\n            console.log(JSON.stringify(geojson))\n            ldnMap.addSource(\"route\", {\n                \"type\": \"geojson\",\n                \"data\": geojson\n            });\n\n            ldnMap.addLayer({\n                \"id\": \"route\",\n                \"type\": \"line\",\n                \"source\": \"route\",\n                \"interactive\": true,\n                \"layout\": {\n                    \"line-join\": \"round\",\n                    \"line-cap\": \"round\"\n                },\n                \"paint\": {\n                    \"line-color\": \"#888\",\n                    \"line-dasharray\": [2, 2],\n                    \"line-width\": {\"stops\": [[2, 0.5], [12, 2]]}\n                    //\"line-width\": 2\n                }\n            });\n        })\n});"]}