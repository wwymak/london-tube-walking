{"version":3,"sources":["../../es6_js/tube-walking-map.js"],"names":[],"mappings":"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","file":"tube-walking-map.js","sourcesContent":["/**\n * Created by wwymak on 19/12/2015.\n */\n\nvar mapWidget = {\n    initMap(){\n        mapboxgl.accessToken = 'pk.eyJ1Ijoid3d5bWFrIiwiYSI6IkxEbENMZzgifQ.pxk3bdzd7n8h4pKzc9zozw';\n        var map = new mapboxgl.Map({\n            container: 'map', // container id\n            style: 'mapbox://styles/mapbox/emerald-v8', //stylesheet location\n            //style: 'mapbox://styles/mapbox/streets-v8',\n            center: [-0.1275, 51.5072], // starting position\n            zoom: 12, // starting zoom\n            minZoom: 9\n        });\n        this.mapLayerIDs = [];\n\n        return map;\n    },\n\n    initControls() {\n        $(\"#settingBtn\").on('click', (e) =>{\n            $(\".toolbar\").find(\".btn-selected\").removeClass(\"btn-selected\");\n            $(e.currentTarget).addClass(\"btn-selected\");\n            $(\"#map-panel-content\").animate({\"width\": 280}, 500, () => {\n                $(\"#closeMenuBtn\").addClass('panel-active');\n            });\n            $(\"#routes-all-selector\").removeClass('content-inactive').addClass('content-active')\n            $(\"#search-routes\").removeClass('content-active').addClass('content-inactive')\n        });\n\n        $(\"#searchBtn\").on('click', (e) =>{\n            $(\".toolbar\").find(\".btn-selected\").removeClass(\"btn-selected\");\n            $(e.currentTarget).addClass(\"btn-selected\");\n            $(\"#map-panel-content\").animate({\"width\": 280}, 500, () => {\n                $(\"#closeMenuBtn\").addClass('panel-active');\n            });\n\n            mapWidget.mapLayerIDs.forEach(d => {\n                mapWidget.showOrHIdeLayer(ldnMap, d, \"none\")\n            });\n\n            $(\"#search-routes\").removeClass('content-inactive').addClass('content-active')\n            $(\"#routes-all-selector\").removeClass('content-active').addClass('content-inactive')\n        });\n\n        $(\"#closeMenuBtn\").on('click', () =>{\n            $(\".toolbar\").find(\".btn-selected\").removeClass(\"btn-selected\");\n            $(\"#map-panel-content\").animate({\"width\": 0}, 500, () =>{\n                $(\"#closeMenuBtn\").removeClass('panel-active');\n            });\n        });\n\n        $(\"#infoBtn\").on(\"click\", (e) => {\n            $(\".toolbar\").find(\".btn-selected\").removeClass(\"btn-selected\");\n            $(e.currentTarget).addClass(\"btn-selected\");\n            $(\"#infoLightBox\").show();\n            $(\"#closeMenuBtn\").trigger(\"click\");\n        });\n\n        $(document).on('keyup', (e) => {\n            if(e.keyCode == 27){\n                $(\"#infoLightBox\").hide();\n                $(\"#infoBtn\").removeClass(\"btn-selected\");\n            }\n        });\n\n        $(\"#closeLightBoxBtn\").on(\"click\", ()=>{\n            $(\"#infoLightBox\").hide();\n            $(\"#infoBtn\").removeClass(\"btn-selected\");\n        });\n\n        $(\"#less5minsBtn\").on('click', (e) => {\n            mapWidget.mapLayerIDs.forEach(d => {\n                mapWidget.showOrHIdeLayer(ldnMap, d, \"none\")\n            });\n            mapWidget.showOrHIdeLayer(ldnMap, \"less5mins\", \"visible\");\n            $(\".layer-selector\").each((d, el) => $(el).removeClass(\"selected\"));\n            $(e.currentTarget).addClass(\"selected\");\n        });\n\n        $(\"#less15minsBtn\").on('click', (e) => {\n            mapWidget.mapLayerIDs.forEach(d => {\n                mapWidget.showOrHIdeLayer(ldnMap, d, \"none\")\n            });\n            mapWidget.showOrHIdeLayer(ldnMap, \"less15mins\", \"visible\");\n            $(\".layer-selector\").each((d, el) => $(el).removeClass(\"selected\"));\n            $(e.currentTarget).addClass(\"selected\");\n        });\n\n        $(\"#less30minsBtn\").on('click', (e) => {\n            mapWidget.mapLayerIDs.forEach(d => {\n                mapWidget.showOrHIdeLayer(ldnMap, d, \"none\");\n            });\n            mapWidget.showOrHIdeLayer(ldnMap, \"less30mins\", \"visible\");\n            $(\".layer-selector\").each((d, el) => $(el).removeClass(\"selected\"));\n            $(e.currentTarget).addClass(\"selected\");\n        });\n    },\n\n    /**\n     *\n     * @param range e.g. 0.6-1.2 (in kms) for approx walking time of 5-10 mins\n     * @returns {*} jquery deferred\n     */\n    loadDataInDistanceRange(range){\n        return $.ajax('/api/distRange/' + range);\n    },\n\n    parseToGeojson(data){\n        var geoJson = {};\n        geoJson.type = \"FeatureCollection\";\n        geoJson.features = []\n        for (let i of data){\n            var routePoints = [];\n            i.routePoints.forEach(function(d){\n                var b = d[1];\n                d[1] = d[0];\n                d[0] = b;\n                routePoints.push(d)\n            });\n            let feature = {};\n            feature.type = \"Feature\";\n            feature.properties= {\n                distance: i.distance\n            };\n            feature.geometry = {\n                \"type\": \"LineString\",\n                \"coordinates\": ([[i.point1.lng,i.point1.lat]]).concat(routePoints, [[i.point2.lng,i.point2.lat]])\n            };\n            geoJson.features.push(feature);\n        }\n\n        console.log(geoJson)\n        return geoJson;\n    },\n\n    parseToMarkerGeojson(data){\n        var geoJson = {};\n        geoJson.type = \"FeatureCollection\";\n        geoJson.features = [];\n        for (let i of data){\n            geoJson.features.push({\n                type: \"Feature\",\n                properties: {\n                    \"marker-symbol\": \"rail-metro\",\n                    \"marker-size\": \"medium\",\n                    \"description\": i.point2.name\n                },\n                geometry: {\n                    \"type\": \"Point\",\n                    \"coordinates\": [i.point2.lng, i.point2.lat]\n                }\n            }, {\n                type: \"Feature\",\n                properties: {\n                    \"marker-symbol\": \"rail\",\n                    \"marker-size\": \"medium\",\n                    \"description\": i.point1.name\n                },\n                geometry: {\n                    \"type\": \"Point\",\n                    \"coordinates\": [i.point1.lng, i.point1.lat]\n                }\n            });\n\n        }\n        return geoJson\n    },\n\n    addDataToMap(map, sourceName, geojson, lineColor, opacity = 1, visibility = \"none\") {\n        map.addSource(sourceName, {\n            \"type\": \"geojson\",\n            \"data\": geojson\n        });\n\n        map.addLayer({\n            \"id\": sourceName,\n            \"type\": \"line\",\n            \"source\": sourceName,\n            \"interactive\": true,\n            \"layout\": {\n                \"line-join\": \"round\",\n                \"line-cap\": \"round\",\n            },\n            \"paint\": {\n                \"line-color\": lineColor,\n                \"line-dasharray\": [2, 2],\n                \"line-width\": {\"stops\": [[2, 0.5], [12, 2]]},\n                \"line-opacity\": opacity,\n            }\n        });\n\n        this.mapLayerIDs.push(sourceName);\n\n        this.showOrHIdeLayer(map, sourceName, visibility);\n    },\n\n    addMarkerToMap(map, sourceName, geojson) {\n        map.addSource(sourceName, {\n            \"type\": \"geojson\",\n            \"data\": geojson\n        });\n\n        map.addLayer({\n            \"id\": sourceName,\n            \"type\": \"symbol\",\n            \"source\": sourceName,\n            \"interactive\": true,\n            \"layout\": {\n                \"icon-image\": \"rail-metro-15\", // note emerald doesn't come with these icons...\n                \"text-field\": \"{description}\"\n            }\n        });\n    },\n\n    /**\n     *\n     * @param map\n     * @param layerID -- maplayer id as specified in addLayer\n     * @param show -- 'visible' or 'none'\n     */\n    showOrHIdeLayer(map, layerID, show = 'visible'){\n        map.setLayoutProperty(layerID, 'visibility', show);\n    },\n\n    plotOneRoute(data, map) {\n        var geojsonRoute = this.parseToGeojson(data),\n            geojsonMarkers = this.parseToMarkerGeojson(data);\n\nconsole.log(geojsonMarkers)\n        if(map.getLayer('searchRoute')){\n            map.removeSource('searchRoute')\n            map.removeLayer('searchRoute')\n        }\n\n        this.addDataToMap(map, \"searchRoute\", geojsonRoute, \"blue\", 1, \"visible\");\n        //\n        if(map.getLayer('searchRouteMarker')){\n            map.removeLayer('searchRouteMarker');\n            map.removeSource('searchRouteMarker');\n        }\n\n        this.addMarkerToMap(map, \"searchRouteMarker\", geojsonMarkers);\n        var bounds = [];\n        geojsonMarkers.features.forEach(d => {\n            bounds.push(d.geometry.coordinates)\n        });\n        this.zoomToBounds(bounds, ldnMap);\n    },\n\n    zoomToBounds(lngLatArr, map) {\n        map.fitBounds(lngLatArr)\n    }\n};\n\nvar mapControls = {\n    initAutoComplete: function(){\n        var fromInput = document.getElementById(\"fromStationInput\"),\n            toInput = document.getElementById(\"toStationInput\");\n\n        mapControls.resetStationQueryParams();\n        mapControls.getStationNames().then(dataArr =>{\n            mapControls.fromAutoComplete = new Awesomplete(fromInput, {list: dataArr});\n            mapControls.toAutoComplete = new Awesomplete(toInput, {list: dataArr});\n\n            document.addEventListener('awesomplete-selectcomplete', () => {\n                mapControls.stationQueryFrom = document.querySelector(\"#fromStationInput\").value;\n                mapControls.enableSearchRouteBtn();\n            });\n\n            document.addEventListener('awesomplete-selectcomplete', () => {\n                mapControls.stationQueryTo = document.querySelector(\"#toStationInput\").value;\n                mapControls.enableSearchRouteBtn();\n            });\n        });\n\n\n\n        $(\"#mapCustomRouteBtn\").on(\"click\", () => {\n            $.ajax({\n                url: '/api/custom-route-search',\n                method: \"POST\",\n                //contentType: \"application/json\",\n                data: {\n                    point1: mapControls.stationQueryFrom,\n                    point2: mapControls.stationQueryTo\n                }\n            }).then(function(data){\n                mapWidget.plotOneRoute(data, ldnMap);\n\n\n            }, function(err){\n                alert(\"cannot find route...\");\n            })\n        })\n    },\n\n    resetStationQueryParams: function(){\n        mapControls.stationQueryFrom = null;\n        mapControls.stationQueryTo = null;\n        $(\"#mapCustomRouteBtn\").prop(\"disabled\", true);\n    },\n\n    enableSearchRouteBtn: function(){\n        var searchRouteBtn = $(\"#mapCustomRouteBtn\");\n        if(mapControls.stationQueryFrom != \"\" && mapControls.stationQueryFrom != null\n            && mapControls.stationQueryTo != null && mapControls.stationQueryTo != \"\"){\n            searchRouteBtn.prop(\"disabled\", false);\n        }\n    },\n\n    getStationNames: function(){\n        return $.ajax(\"/api/tube-stations-names\").then(dataArr =>{\n            mapControls.tubeStationList = dataArr\n            return dataArr\n        })\n    },\n\n    hideSearchSection: function(){\n        mapControls.resetStationQueryParams();\n        $(\"#search-routes\").removeClass('content-active').addClass('content-inactive');\n    }\n}\n\nvar ldnMap = mapWidget.initMap();\n\n\nldnMap.on('style.load', () =>{\n    mapWidget.loadDataInDistanceRange('0-0.6').then(mapWidget.parseToGeojson)\n        .then(function(geojson){\n        mapWidget.addDataToMap(ldnMap, \"less5mins\", geojson, \"#dd3497\", 0.8)\n    });\n\n    mapWidget.loadDataInDistanceRange('0.6-1.8').then(mapWidget.parseToGeojson)\n        .then(function(geojson){\n            mapWidget.addDataToMap(ldnMap, \"less15mins\", geojson, \"#005a32\", 0.5, \"visible\");\n\n        }).then(function(){\n            $(\"#initLoadingScreen\").addClass(\"inactive\");\n            $(\"#infoLightBox\").removeClass(\"inactive\")\n        });\n\n    mapWidget.loadDataInDistanceRange('1.8-3.6').then(mapWidget.parseToGeojson)\n        .then(function(geojson){\n            mapWidget.addDataToMap(ldnMap, \"less30mins\", geojson, \"#8c96c6\")\n        });\n\n    ldnMap.on('load', ()=> {\n        mapWidget.initControls();\n        mapControls.initAutoComplete();\n    });\n\n\n\n\n});"]}